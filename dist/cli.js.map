{"version":3,"sources":["../src/cli.ts","../package.json","../src/cli/apply.ts"],"names":["yargs","hideBin","command","describe","builder","handler","cwd","process","sh","ScaffoldingHandler","module","findScaffoldFiles","register","init","exec","error","console","exit","argv","version","scriptName","applyCommand","help","demandCommand","strictCommands","showHelpOnFail","fail","msg","err","log","parse"],"mappings":";;;;;;;AAEA,OAAOA,WAAW;AAClB,SAASC,eAAe;;;ACDtB,cAAW;;;ACCN,IAAMC,UAA+B;EAC1CA,SAAS;EACTC,UAAU;EACVC,SAAS,CAAC;EACVC,SAAS,YAAA;AACP,QAAI;AACF,YAAMC,MAAMC,QAAQD,IAAG;AAEvB,YAAME,KAAK,IAAIC,mBAAmBH,GAAAA;AAElC,uBAAiBI,UAAUC,kBAAkB;QAAEL;MAAI,CAAA,GAAI;AACrDE,WAAGI,SAASF,MAAAA;MACd;AAGA,YAAMF,GAAGK,KAAI;AAIb,YAAML,GAAGM,KAAI;IACf,SAASC,OAAO;AAEdC,cAAQD,MAAMA,KAAAA;AACdR,cAAQU,KAAK,CAAA;IACf;EACF;AACF;;;AFrBAjB,MAAMC,QAAQM,QAAQW,IAAI,CAAA,EACvBC,QAAQA,OAAAA,EACRC,WAAW,UAAA,EACXlB,QAAQmB,OAAAA,EACRC,KAAI,EACJC,cAAc,CAAA,EACdC,eAAe,IAAA,EACfC,eAAe,IAAA,EACfC,KAAK,CAACC,KAAKC,QAAAA;AAEV,MAAID;AAAKX,YAAQa,IAAIF,GAAAA;AACrB,MAAIC,KAAK;AAEPZ,YAAQD,MAAMa,GAAAA;EAChB;AAEAZ,UAAQa,IAAI,4BAAA;AACZtB,UAAQU,KAAK,CAAA;AACf,CAAA,EACCa,MAAK","sourcesContent":["#!/usr/bin/env node\n\nimport yargs from 'yargs';\nimport { hideBin } from 'yargs/helpers';\n\nimport { version } from '../package.json';\nimport { command as applyCommand } from './cli/apply';\n\nyargs(hideBin(process.argv))\n  .version(version)\n  .scriptName('scaffold')\n  .command(applyCommand)\n  .help()\n  .demandCommand(1)\n  .strictCommands(true)\n  .showHelpOnFail(true)\n  .fail((msg, err) => {\n    // eslint-disable-next-line no-console\n    if (msg) console.log(msg);\n    if (err) {\n      // eslint-disable-next-line no-console\n      console.error(err);\n    }\n    // eslint-disable-next-line no-console\n    console.log(\"Use '--help' for more info\");\n    process.exit(1);\n  })\n  .parse();\n","{\n  \"name\": \"@povio/scaffold\",\n  \"version\": \"1.0.0\",\n  \"author\": \"Marko Zabreznik <marko.zabreznik@povio.com> (https://zabreznik.net)\",\n  \"scripts\": {\n    \"build\": \"tsup\",\n    \"cli\": \"DEBUG_COLORS=1 DEBUG='scaffold:*' node -r @swc-node/register src/cli.ts\",\n    \"test\": \"DEBUG_COLORS=1 DEBUG='scaffold:*' node --test -r @swc-node/register src/**/*.test.ts\",\n    \"test:watch\": \"DEBUG_COLORS=1 DEBUG='scaffold:*' node --test --watch -r @swc-node/register src/**/*.test.ts\",\n    \"lint\": \"eslint \\\"{src,test}/**/*.ts\\\"\",\n    \"lint:fix\": \"eslint \\\"{src,test}/**/*.ts\\\" --fix\"\n  },\n  \"main\": \"dist/index.js\",\n  \"module\": \"dist/index.mjs\",\n  \"types\": \"dist/index.d.ts\",\n  \"exports\": {\n    \".\": {\n      \"types\": \"./dist/index.d.ts\",\n      \"require\": \"./dist/index.js\",\n      \"import\": \"./dist/index.mjs\"\n    }\n  },\n  \"bin\": \"./dist/cli.js\",\n  \"dependencies\": {\n    \"@types/interpret\": \"^1.1.3\",\n    \"@types/yargs\": \"^17.0.32\",\n    \"cosmiconfig\": \"^9.0.0\",\n    \"fast-glob\": \"^3.3.2\",\n    \"interpret\": \"^3.1.1\",\n    \"rechoir\": \"^0.8.0\",\n    \"semver\": \"^7.6.0\",\n    \"ts-morph\": \"^22.0.0\",\n    \"yargs\": \"^17.7.2\",\n    \"zod\": \"^3.23.6\"\n  },\n  \"devDependencies\": {\n    \"@swc-node/register\": \"^1.9.1\",\n    \"@swc/core\": \"^1.5.3\",\n    \"@types/debug\": \"^4.1.12\",\n    \"@types/lodash\": \"^4.17.1\",\n    \"@types/rechoir\": \"^0.6.4\",\n    \"@types/semver\": \"^7.5.8\",\n    \"@typescript-eslint/eslint-plugin\": \"^7.8.0\",\n    \"@typescript-eslint/parser\": \"^7.8.0\",\n    \"debug\": \"^4.3.4\",\n    \"eslint\": \"^8.57.0\",\n    \"eslint-config-prettier\": \"^9.1.0\",\n    \"eslint-plugin-import-helpers\": \"^1.3.1\",\n    \"eslint-plugin-prettier\": \"^5.1.3\",\n    \"prettier\": \"^3.2.5\",\n    \"supports-color\": \"^9.4.0\",\n    \"tsup\": \"^8.0.2\",\n    \"typescript\": \"^5.4.5\"\n  },\n  \"packageManager\": \"yarn@4.1.1+sha256.f3cc0eda8e5560e529c7147565b30faa43b4e472d90e8634d7134a37c7f59781\"\n}\n","import { ScaffoldingHandler, findScaffoldFiles } from '@povio/scaffold';\nimport yargs from 'yargs';\n\nexport const command: yargs.CommandModule = {\n  command: 'apply',\n  describe: 'apply scaffolding',\n  builder: {},\n  handler: async () => {\n    try {\n      const cwd = process.cwd();\n\n      const sh = new ScaffoldingHandler(cwd);\n\n      for await (const module of findScaffoldFiles({ cwd })) {\n        sh.register(module);\n      }\n\n      // load all modules\n      await sh.init();\n\n      // execute all modules in order\n      // todo, ask for confirmation\n      await sh.exec();\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(error);\n      process.exit(1);\n    }\n  },\n};\n"]}